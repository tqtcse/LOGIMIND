import{u as d,b as K,r as A,j as r,c as E,S as v,d as x,e as T,H as B,f as I,g as _}from"./index-DtwSxASm.js";import{S as L}from"./useResponsive-DY1IWvVa.js";import{V}from"./VerticalMenuContent-CUFtnFE0.js";import{n as W}from"./index-CjgVxIQo.js";import{C as e}from"./index-BjgA-DNM.js";const s="FMSdarBAdtoan",D="http://103.97.127.14:3000",$={width:x,minWidth:x},k={width:v,minWidth:v},F=({translationSetup:N=I.activeNavTranslation,background:C=!0,className:j,contentClass:w,mode:O})=>{d(t=>t.mode);const l=d(t=>t.direction),i=d(t=>t.layout.sideNavCollapse),R=K(t=>t.currentRouteKey),[U,c]=A.useState(["user"]);return A.useEffect(()=>{(async()=>{const m=localStorage.getItem("token"),n=localStorage.getItem("email");var u="";n&&(u=e.AES.decrypt(n,s).toString(e.enc.Utf8));const S=await _.post(`${D}/user/get-user-id?`,{email:u},{headers:{Authorization:`Bearer ${m}`}});localStorage.setItem("userid",e.AES.encrypt(S.data.id,s).toString());const H=await _.get(`${D}/order/get-orderDetail`,{headers:{Authorization:`Bearer ${m}`}}),g=S.data.id,p=H.data;p.find(o=>o.id_account===g);const y=p.filter(o=>o.id_account===g);if(y.length>0){const o=y.reduce((a,f)=>new Date(f.expired_datetime)>new Date(a.expired_datetime)?f:a);if(new Date(o.expired_datetime)>new Date){const a=localStorage.getItem("role");a&&(e.AES.decrypt(a,s).toString(e.enc.Utf8)==="admin"?c(["admin"]):(c(["users"]),localStorage.setItem("role",e.AES.encrypt("users",s).toString())))}else console.log("❌ Gói này đã hết hạn.")}else console.log("❌ Không tìm thấy order nào cho user này.");n&&e.AES.decrypt(n,s).toString(e.enc.Utf8);const h=localStorage.getItem("role");h&&e.AES.decrypt(h,s).toString(e.enc.Utf8)==="admin"&&c(["admin"])})()},[]),r.jsxs("div",{style:i?k:$,className:E("side-nav",C&&"side-nav-bg",!i&&"side-nav-expand",j),children:[r.jsx(T,{to:I.authenticatedEntryPath,className:"side-nav-header flex flex-col justify-center",style:{height:B}}),r.jsx("div",{className:E("side-nav-content",w),children:r.jsx(L,{style:{height:"100%"},direction:l,children:r.jsx(V,{collapsed:i,navigationTree:W,routeKey:R,direction:l,translationSetup:N,userAuthority:U||[]})})})]})};export{F as S};
