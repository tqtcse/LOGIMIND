import{j as s,r as d,n as w,a3 as V,a4 as se}from"./index-DtwSxASm.js";import{c as S}from"./classNames-ePRZs5sB.js";import{c as ae}from"./cloneDeep-BSOSHLnM.js";import{V as ne,a as re,b as ie}from"./index-BnPKvy3X.js";import{B as le}from"./Button-i5g00eBi.js";import{C as W}from"./CloseButton-C-zx-kDW.js";import{u as oe,S as ce}from"./StatusIcon-C3ptiLRj.js";import{m as ue}from"./proxy-CApU-jHi.js";const de=1e3,pe=t=>Math.round(t/de),U=({children:t})=>s.jsx("span",{className:"text-3xl heading-text",children:t}),_=t=>{const{file:e,children:a,className:r}=t,{type:n,name:l,size:p}=e,o=()=>n.split("/")[0]==="image"?s.jsx("img",{className:"upload-file-image",src:URL.createObjectURL(e),alt:`file preview ${l}`}):n==="application/zip"?s.jsx(U,{children:s.jsx(ne,{})}):n==="pdf"?s.jsx(U,{children:s.jsx(re,{})}):s.jsx(U,{children:s.jsx(ie,{})});return s.jsxs("div",{className:S("upload-file",r),children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"upload-file-thumbnail",children:o()}),s.jsxs("div",{className:"upload-file-info",children:[s.jsx("h6",{className:"upload-file-name text-sm font-bold",children:l}),s.jsxs("span",{className:"upload-file-size",children:[pe(p)," kb"]})]})]}),a]})};_.displayName="UploadFileItem";const me=t=>{const{className:e,children:a,closable:r=!1,customIcon:n,duration:l=3e3,onClose:p,style:o,ref:c,title:f,triggerByToast:h,type:b,width:I=350,...N}=t,[y,v]=d.useState("show"),{clear:j}=oe(p,l,l>0),C=d.useCallback(g=>{v("hiding"),p==null||p(g),j(),h||setTimeout(()=>{v("hide")},400)},[p,j,h]),m=w("notification",e);return y==="hide"?null:s.jsxs("div",{ref:c,...N,className:m,style:{width:I,...o},children:[s.jsxs("div",{className:w("notification-content",!a&&"no-child"),children:[b&&!n?s.jsx("div",{className:"mr-3 mt-0.5",children:s.jsx(ce,{type:b})}):null,n&&s.jsx("div",{className:"mr-3",children:n}),s.jsxs("div",{className:"mr-4",children:[f&&s.jsx("div",{className:w("notification-title",a?"mb-2":""),children:f}),s.jsx("div",{className:w("notification-description",!f&&a?"mt-1":""),children:a})]})]}),r&&s.jsx(W,{className:"notification-close",absolute:!0,onClick:C})]})};function fe(...t){return t.filter(e=>e!==null&&typeof e<"u").reduce((e,a)=>{if(typeof a!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return e===void 0?a:function(...n){e.apply(this,n),a.apply(this,n)}},void 0)}const he=({offsetX:t,offsetY:e,placement:a,transitionType:r})=>r==="fade"?ve(t,e)[a]:ge(t,e)[a],E={initial:{opacity:0,transform:"scale(0.75)"},animate:{transform:"scale(1)",opacity:1},exit:{opacity:0,transform:"scale(0.75)"}},F={initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}},ge=(t,e)=>({"top-end":{default:{top:e,right:t},variants:{...E}},"top-start":{default:{top:e,left:t},variants:{...E}},"top-center":{default:{top:e,left:"50%",transform:"translateX(-50%)"},variants:{...E}},"bottom-end":{default:{bottom:e,right:t},variants:{...E}},"bottom-start":{default:{bottom:e,left:t},variants:{...E}},"bottom-center":{default:{bottom:e,left:"50%",transform:"translateX(-50%)"},variants:{...E}}}),ve=(t,e)=>({"top-end":{default:{top:e,right:t},variants:{...F}},"top-start":{default:{top:e,left:t},variants:{...F}},"top-center":{default:{top:e,left:"50%",transform:"translateX(-50%)"},variants:{...F}},"bottom-end":{default:{bottom:e,right:t},variants:{...F}},"bottom-start":{default:{bottom:e,left:t},variants:{...F}},"bottom-center":{default:{bottom:e,left:"50%",transform:"translateX(-50%)"},variants:{...F}}}),be=t=>{const[e,a]=d.useState([]),r=d.useCallback(o=>(typeof o>"u"&&e.length&&(o=e[e.length-1].key),o),[e]),n=d.useCallback(o=>{const c=t||"_"+Math.random().toString(36).substr(2,12);return a([...e,{key:c,visible:!0,node:o}]),c},[e,t]),l=d.useCallback(()=>{a(e.map(o=>({...o,visible:!1}))),setTimeout(()=>{a([])},50)},[e]),p=d.useCallback(o=>{a(e.map(c=>(c.key===r(o)&&(c.visible=!1),c))),setTimeout(()=>{a(e.filter(c=>c.visible))},50)},[e,r]);return{messages:e,push:n,removeAll:l,remove:p}},M=t=>{const e=d.useRef(null),{transitionType:a="scale",placement:r=V.TOP_END,offsetX:n=30,offsetY:l=30,messageKey:p,block:o=!1,ref:c,callback:f,...h}=t,{push:b,removeAll:I,remove:N,messages:y}=be(p);d.useImperativeHandle(c,()=>({root:e.current,push:b,removeAll:I,remove:N}));const v=he({offsetX:n,offsetY:l,placement:r,transitionType:a}),j={triggerByToast:!0,...h},C=y.map(m=>{var g,k,O,T;return s.jsx(ue.div,{className:"toast-wrapper",initial:v.variants.initial,variants:v.variants,animate:m.visible?"animate":"exit",transition:{duration:.15,type:"tween"},children:d.cloneElement(m.node,{...j,ref:c,onClose:fe((k=(g=m.node)==null?void 0:g.props)==null?void 0:k.onClose,()=>N(m.key)),className:w((T=(O=m.node)==null?void 0:O.props)==null?void 0:T.className)})},m.key)});return s.jsx("div",{style:v.default,...h,ref:m=>{e.current=m,f==null||f(m)},className:w("toast",o&&"w-full"),children:C})};M.getInstance=t=>{const{wrapper:e,...a}=t,r=d.createRef(),n=(typeof e=="function"?e():e)||document.body;return new Promise(l=>{const p=()=>{l([r,c])};function o(f){const h=document.createElement("div");n.appendChild(h);const b=se.createRoot(h);return b.render(f),b}const{unmount:c}=o(s.jsx(M,{...a,ref:r,callback:p}))})};const xe={placement:V.TOP_END,offsetX:30,offsetY:30,transitionType:"scale",block:!1},J="default",D=new Map;function ye(t){if(/\top\b/.test(t))return"top-full";if(/\bottom\b/.test(t))return"bottom-full"}async function Ne(t,e){const[a]=await M.getInstance(e);return D.set(t||J,a),a}function je(t){return D.size===0?null:D.get(t||J)}const P=t=>P.push(t);P.push=(t,e=xe)=>{let a=e.placement;e.block&&(a=ye(e.placement));const r=je(a);return r!=null&&r.current?r.current.push(t):Ne(a??"",e).then(n=>{var l;return(l=n.current)==null?void 0:l.push(t)})};P.remove=t=>{D.forEach(e=>{e.current.remove(t)})};P.removeAll=()=>{D.forEach(t=>t.current.removeAll())};const z=t=>Object.keys(t).map(e=>t[e]),Pe=t=>{const{accept:e,beforeUpload:a,disabled:r=!1,draggable:n=!1,fileList:l=[],fileListClass:p,fileItemClass:o,multiple:c,onChange:f,onFileRemove:h,ref:b,showList:I=!0,tip:N,uploadLimit:y,children:v,className:j,...C}=t,m=d.useRef(null),[g,k]=d.useState(l),[O,T]=d.useState(!1);d.useEffect(()=>{JSON.stringify(g)!==JSON.stringify(l)&&k(l)},[JSON.stringify(l)]);const A=(u="")=>{P.push(s.jsx(me,{type:"danger",duration:2e3,children:u||"Upload Failed!"}),{placement:"top-center"})},B=(u,i)=>{if(u)for(const x of u)i.push(x);return i},$=u=>{let i=ae(g);return typeof y=="number"&&y!==0&&Object.keys(i).length>=y?(y===1&&(i.shift(),i=B(u,i)),z({...i})):(i=B(u,i),z({...i}))},K=u=>{const{files:i}=u.target;let x=!0;if(a){if(x=a(i,g),x===!1){A();return}if(typeof x=="string"&&x.length>0){A(x);return}}if(x){const L=$(i);k(L),f==null||f(L,g)}},H=u=>{const i=g.filter((x,L)=>L!==u);k(i),h==null||h(i)},Z=u=>{var i;r||(i=m.current)==null||i.click(),u.stopPropagation()},q=()=>!n&&!v?s.jsx(le,{disabled:r,onClick:u=>u.preventDefault(),children:"Upload"}):n&&!v?s.jsx("span",{children:"Choose a file or drag and drop here"}):v,G=d.useCallback(()=>{n&&T(!1)},[n]),Q=d.useCallback(()=>{n&&!r&&T(!0)},[n,r]),X=d.useCallback(()=>{n&&T(!1)},[n]),Y={onDragLeave:G,onDragOver:Q,onDrop:X},R="border-primary",ee=S("upload",n&&"upload-draggable",n&&!r&&`hover:${R}`,n&&r&&"disabled",O&&R,j),te=S("upload-input",n&&"draggable");return s.jsxs(s.Fragment,{children:[s.jsxs("div",{ref:b,className:ee,...n?Y:{onClick:Z},...C,children:[s.jsx("input",{ref:m,className:te,type:"file",disabled:r,multiple:c,accept:e,title:"",value:"",onChange:K,...C}),q()]}),N,I&&s.jsx("div",{className:S("upload-file-list",p),children:g.map((u,i)=>s.jsx(_,{file:u,className:o,children:s.jsx(W,{className:"upload-file-remove",onClick:()=>H(i)})},u.name+i))})]})};export{me as N,Pe as U,P as t};
