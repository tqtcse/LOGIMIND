import{j as e,r as l,g as N,$ as z,F as K,C as R,B as U}from"./index-DtwSxASm.js";import{a as k,C,u as X,F as H}from"./index.esm-Cn3F_1Fv.js";import"./context-DPxwjVT1.js";import{C as J}from"./Card-CvsXYMKX.js";import{I as P}from"./Input-BNk8Jtou.js";import{N as Q}from"./react-number-format.es-Cj5ZwSfX.js";import{L as W,y}from"./index-DPBfSoHl.js";/* empty css                      */import{a as Y}from"./index-DYfuKO4A.js";import"./classNames-ePRZs5sB.js";import"./isNil-BVBaoyN1.js";import"./proxy-CApU-jHi.js";const Z=({inputSuffix:n,inputPrefix:o,...p})=>e.jsx(P,{...p,value:p.value,suffix:n,prefix:o}),ee=({onValueChange:n,...o})=>e.jsx(Q,{customInput:Z,onValueChange:n,...o}),M=({inputSuffix:n,inputPrefix:o,onValueChange:p,...d})=>e.jsx(ee,{inputPrefix:o,inputSuffix:n,onValueChange:p,...d}),w="http://103.97.127.14:3000",te=({control:n,errors:o})=>{var F,B,O,D,E;const[p,d]=l.useState(null),[h,I]=l.useState(""),[$,S]=l.useState([]),[r,i]=l.useState(null),[u,A]=l.useState(null),[T,q]=l.useState(0);l.useEffect(()=>{sessionStorage.getItem("hasReloadedCreatePackage")||(sessionStorage.setItem("hasReloadedCreatePackage","true"),window.location.reload())},[]),l.useEffect(()=>{(async()=>{const t=localStorage.getItem("token");try{const s=await N.get(`${w}/packages/packages`,{headers:{Authorization:`Bearer ${t}`}});S(s.data)}catch(s){console.error("Error:",s)}})()},[T]);const j=a=>{const t=$.find(s=>s.id===a);t?(i(t),A(t),y.success("Gói đã được tìm thấy!",{autoClose:1e3})):(i(null),A(null),y.error("Không tìm thấy gói nào cả!",{autoClose:1e3}))},V=async()=>{var a,t,s,g;try{const c=(a=document.querySelector("#packagename"))==null?void 0:a.getAttribute("value"),m=(t=document.querySelector("#index"))==null?void 0:t.getAttribute("value"),x=r?r.description:"",f=(s=document.querySelector("#price"))==null?void 0:s.getAttribute("value"),b=(g=document.querySelector("#day"))==null?void 0:g.getAttribute("value"),v=localStorage.getItem("token");(await N.delete(`${w}/packages/delete-package/${m}`,{headers:{Authorization:`Bearer ${v}`}})).data&&(sessionStorage.removeItem("hasReloadedsPricing"),y.success("Xóa thành công!",{autoClose:2e3}),setTimeout(()=>{window.location.reload()},2e3))}catch(c){console.log(c)}},_=async()=>{var a,t,s,g;try{const c=(a=document.querySelector("#packagename"))==null?void 0:a.getAttribute("value"),m=(t=document.querySelector("#index"))==null?void 0:t.getAttribute("value"),x=r?r.description:"",f=(s=document.querySelector("#price"))==null?void 0:s.getAttribute("value"),b=(g=document.querySelector("#day"))==null?void 0:g.getAttribute("value"),v=localStorage.getItem("token");if(!m||!c||!x||!f||!b){console.log("Vui lòng nhập đầy đủ thông tin!");return}(await N.post(`${w}/packages/add-package`,{id_package:m,packagename:c,description:x,price:f,day:b},{headers:{Authorization:`Bearer ${v}`}})).data&&(sessionStorage.removeItem("hasReloadedsPricing"),y.success("Tạo thành công!",{autoClose:2e3}),setTimeout(()=>{window.location.reload()},2e3))}catch(c){y.error("Gói đã tồn tại!",{autoClose:2e3}),console.log(c)}},G=async()=>{var a,t,s,g;try{const c=(a=document.querySelector("#packagename"))==null?void 0:a.getAttribute("value"),m=(t=document.querySelector("#index"))==null?void 0:t.getAttribute("value"),x=r?r.description:"",f=(s=document.querySelector("#price"))==null?void 0:s.getAttribute("value"),b=(g=document.querySelector("#day"))==null?void 0:g.getAttribute("value"),v=localStorage.getItem("token");if(console.log(c,m,x,f,b),!m||!c||!x||!f||!b){console.log("Vui lòng nhập đầy đủ thông tin!");return}const L=await N.put(`${w}/packages/update-package`,{id:m,packagename:c,description:x,price:f,day:b},{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});sessionStorage.removeItem("hasReloadedsPricing"),y.success("Cập nhật thành công!",{autoClose:2e3}),setTimeout(()=>{window.location.reload()},2e3)}catch(c){console.log(c),y.error("Không tìm thấy gói!",{autoClose:2e3})}};return e.jsxs(J,{id:"customerDetails",children:[e.jsx(W,{}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(P,{type:"text",placeholder:"Tìm gói theo ID",suffix:e.jsx(Y,{className:"text-lg"}),onChange:a=>I(a.target.value),onKeyDown:a=>{a.key==="Enter"&&j(h)}}),e.jsx("button",{type:"button",onClick:()=>j(h),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"Tìm"}),e.jsx("div",{className:"flex items-end gap-4 w-full"})]}),e.jsx("h4",{className:"mb-6"}),e.jsx(k,{label:"ID",invalid:!!o.lastName,errorMessage:(F=o.lastName)==null?void 0:F.message,children:e.jsx(C,{name:"index",control:n,render:({field:a})=>e.jsx(P,{type:"text",autoComplete:"off",placeholder:"ID",id:"index",...a,value:r?r.id:"",onChange:t=>{i(s=>({...s,id:t.target.value})),a.onChange(t)}})})}),e.jsx(k,{label:"Tên Gói",invalid:!!o.firstName,errorMessage:(B=o.firstName)==null?void 0:B.message,children:e.jsx(C,{name:"packagename",control:n,render:({field:a})=>e.jsx(P,{type:"text",id:"packagename",autoComplete:"off",placeholder:"Tên gói",...a,value:r?r.package_name:"",onChange:t=>{i(s=>({...s,package_name:t.target.value})),a.onChange(t)}})})}),e.jsx(k,{label:"Giá",invalid:!!o.email,errorMessage:(O=o.email)==null?void 0:O.message,children:e.jsx(C,{name:"phoneNumber",control:n,render:({field:a})=>e.jsx(M,{autoComplete:"off",placeholder:"Giá",id:"price",value:r?r.price:"",onChange:t=>{i(s=>({...s,price:Number(t.target.value)})),a.onChange(t)}})})}),e.jsx(k,{label:"Ngày",invalid:!!o.email,errorMessage:(D=o.email)==null?void 0:D.message,children:e.jsx(C,{name:"phoneNumber",control:n,render:({field:a})=>e.jsx(M,{autoComplete:"off",placeholder:"Ngày",id:"day",value:r?r.day:"",onChange:t=>{i(s=>({...s,day:Number(t.target.value)})),a.onChange(t)}})})}),e.jsx(k,{label:"Mô tả",invalid:!!o.email,errorMessage:(E=o.email)==null?void 0:E.message,children:e.jsx(C,{name:"description",control:n,render:({field:a})=>e.jsx("textarea",{rows:6,placeholder:"Nhập mô tả...",id:"description",className:"w-full px-4 py-2 bg-gray-100 text-gray-800 font-bold rounded-lg border-none outline-none",value:r?r.description:"",onChange:t=>{i(s=>({...s,description:t.target.value})),a.onChange(t)}})})}),e.jsx("div",{className:"flex items-end gap-4 w-full"}),e.jsxs("div",{className:"flex items-center gap-4 w-full justify-end mb-4",children:[e.jsx("button",{type:"button",onClick:V,disabled:u===null,className:`px-4 py-2 rounded-md text-white 
                        ${u?"bg-red-500 hover:bg-blue-600":"bg-gray-400 cursor-not-allowed"}`,children:"Xóa"}),e.jsx("button",{type:"button",onClick:G,disabled:u===null,className:`px-4 py-2 rounded-md text-white 
                        ${u?"bg-blue-500 hover:bg-blue-600":"bg-gray-400 cursor-not-allowed"}`,children:"Cập nhật"}),e.jsx("button",{type:"button",onClick:_,disabled:u!==null,className:`px-4 py-2 rounded-md text-white 
                ${u?"bg-gray-400 cursor-not-allowed":"bg-green-500 hover:bg-blue-600"}`,children:"Tạo"})]})]})},ae={productList:[],productOption:[],selectedProduct:[]},oe=z(n=>({...ae,setProductOption:o=>n(()=>({productOption:o})),setProductList:o=>n(()=>({productList:o})),setSelectedProduct:o=>n(()=>({selectedProduct:o}))})),se=n=>{const{onFormSubmit:o,children:p,defaultValues:d,defaultProducts:h}=n,{setProductOption:I,setProductList:$,setSelectedProduct:S}=oe();l.useEffect(()=>(h&&S(h),K(d)||u(d),()=>{S([])}),[]);const r=j=>{o==null||o(j)},{handleSubmit:i,reset:u,watch:A,formState:{errors:T},control:q}=X({defaultValues:{paymentMethod:"creditOrDebitCard",packagename:"",index:"",description:"",...d||{}}});return e.jsx("div",{className:"flex",children:e.jsx(H,{className:"flex-1 flex flex-col overflow-hidden",onSubmit:i(r),children:e.jsx(R,{children:e.jsx("div",{className:"flex gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(te,{control:q,errors:T})})})})})})})},fe=()=>{U();const[n,o]=l.useState(!1),[p,d]=l.useState(!1),h=async I=>{};return e.jsx(e.Fragment,{children:e.jsx(se,{onFormSubmit:h,children:e.jsx(R,{})})})};export{fe as default};
